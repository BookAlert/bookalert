<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">
<head th:replace="partials/partials.html :: head('Profile')">
    <title>User Profile</title>

<body class="profile-body">
<div class="overlay position-fixed"></div>

<main id="profilePage">
    <nav th:replace="partials/partials.html :: navbar"></nav>
    <h1 class="text-center text-light">Welcome to your profile <span th:text="${#authentication.name}">User</span>!</h1>


    <div class="mb-5 justify-content-center d-flex">
        <div class="px-4">
            <div class="card card-accent-dark mb-3" id="authorLibrary" style="width: 240px;">
                <div class="card-header text-center">Your Authors</div>
                <div class="card-body text-dark">
                    <th:block th:if="${#lists.isEmpty(authors)}" class="lead">List of Authors is empty, <a
                            th:href="@{/search}">search</a> authors and add to your list!
                    </th:block>

                    <div th:each="author : ${authors}">
                        <a th:href="@{'/authors/' + ${author.id}}" th:text="${author.name}"></a>
                        <hr>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex-grow-1 px-4" style="max-width: 1200px">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="saved-tab" data-toggle="tab" href="#profileSavedBooks" role="tab"
                       aria-controls="home" aria-selected="true">
                        <span class="badge badge-pill badge-secondary">1 </span> Saved Titles
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="new-tab" data-toggle="tab" href="#profileNewReleases" role="tab"
                       aria-controls="profile" aria-selected="false">
                        <span class="badge badge-pill badge-secondary">2 </span> New Releases
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="upcoming-tab" data-toggle="tab" href="#profileUpcomingReleases" role="tab"
                       aria-controls="contact" aria-selected="false">
                        <span class="badge badge-pill badge-secondary">3 </span> Upcoming Releases
                    </a>
                </li>
            </ul>

       <div class="tab-content" id="myTabContent">
           <div class="tab-pane fade show active" id="saved" role="tabpanel" aria-labelledby="home-tab">
               <div class="card">
                   <section>
                       <h3 class="text-center mt-2 mb-2 card-header">Your Saved Titles</h3>
                       <th:block th:if="${#lists.isEmpty(savedBooks)}" class="lead">You don't have any titles yet,
                           <a th:href="@{/search}">search</a> and add to your list!</th:block>

                       <div class="d-flex flex-wrap flex-grow-1">
                           <div class="saved-book-card" th:each="book : ${savedBooks}"><span>Purchased</span>

                               <div class="card p-1 text-center">
                                   <a th:href="@{'/book/' + ${book.id}}"><img class="mw-100 mh-100" th:src="${book.artwork_url}"></a>
                                   <p th:text="${{#dates.format(book.release_date, 'MM-yyyy-dd')}}" class="lead"> </p>
                                   <button type="button" class="btn btn-outline-danger btn-sm mb-2 delete-title" th:data-book-id="${book.id}"><i class="far fa-trash-alt fa-lg"></i></button>
                                   <a target="_blank" class="btn btn-outline-success btn-sm mb-2 purchase-book" data-toggle="tooltip" data-placement="right" title="Purchase on itunes" th:href="${book.itunes_url}" role="button"><i class="fab fa-itunes fa-lg"></i></a>
                                   <button type="button" class="btn btn-outline-info btn-sm mark-purchased" data-toggle="tooltip" data-placement="right" title="Mark Purchased" th:data-book-id="${book.id}"><i class="fas fa-shopping-bag fa-lg"></i></button>
                               </div>
                           </div>
                       </div>
                   </section>
               </div>
           </div>
           <div class="tab-pane fade" id="newReleases" role="tabpanel" aria-labelledby="profile-tab">
               <div class="card">
                   <section>
                       <h3 class="text-center mt-2 mb-2 card-header">New Releases to your library</h3>
                       <div class="d-flex flex-wrap flex-grow-1">
                           <!--bootstrap card with 3 horizontal images-->
                           <div class="new-release-card p-2" th:each="book : ${newReleases}">
                               <div class="card p-1 text-center mb-3">
                                   <a th:href="@{'/book/' + ${book.id}}"><img class="mw-100 mh-100" th:src="${book.artwork_url}"></a>
                                   <p th:text="${{#dates.format(book.release_date, 'MM-yyyy-dd')}}" class="lead"></p>
                                   <button type="button" class="btn btn-outline-danger btn-sm mb-2 dismiss-new-release" th:data-book-id="${book.id}"><i class="far fa-trash-alt fa-lg"></i></button>
                                   <button type="button" class="btn btn-outline-primary btn-sm mb-2 save-book" data-toggle="tooltip" data-placement="right" title="Save Book" th:data-book-id="${book.id}"><i class="far fa-bookmark fa-lg"></i></button>
                                   <a target="_blank" class="btn btn-outline-success btn-sm mb-2 purchase-book" data-toggle="tooltip" data-placement="right" title="Purchase on itunes" th:href="${book.itunes_url}" role="button"><i class="fab fa-itunes fa-lg"></i></a>
                                   <button type="button" class="btn btn-outline-info btn-sm mark-purchased" data-toggle="tooltip" data-placement="right" title="Mark Purchased" th:data-book-id="${book.id}"><i class="fas fa-shopping-bag fa-lg"></i></button>
                               </div>
                           </div>
                       </div>
                   </section>
                   <div class="row justify-content-center">
                       <button type="button" class="btn btn-outline-danger btn-sm-center dismiss-all">Dismiss All New Releases</button>
                   </div>
               </div>
           </div>
           <div class="tab-pane fade" id="upcomingRelease" role="tabpanel" aria-labelledby="contact-tab">
               <div class="card">
                   <section>
                       <h3 class="text-center mt-2 mb-2 card-header">Upcoming Releases</h3>
                       <div class="d-flex flex-wrap flex-grow-1">
                           <!--bootstrap card with 3 horizontal images-->
                           <div class="upcoming-book-card p-2" th:each="book : ${upcomingReleases}">
                               <div class="card p-1 text-center ">
                                   <a th:href="@{'/book/' + ${book.id}}"><img class="mw-100 mh-100" th:src="${book.artwork_url}"></a>
                                   <p th:text="${{#dates.format(book.release_date, 'MM-yyyy-dd')}}" class="lead"></p>
                                   <button type="button" class="btn btn-outline-danger btn-sm mb-2 dismiss-upcoming-release" th:data-book-id="${book.id}"><i class="far fa-trash-alt fa-lg"></i></button>
                                   <button type="button" class="btn btn-outline-primary btn-sm mb-2 save-upcoming-book" data-toggle="tooltip" data-placement="right" title="Save Book" th:data-book-id="${book.id}"><i class="far fa-bookmark fa-lg"></i></button>
                                   <a target="_blank" class="btn btn-outline-success btn-sm mb-2 purchase-book" data-toggle="tooltip" data-placement="right" title="Purchase on itunes" th:href="${book.itunes_url}" role="button"><i class="fab fa-itunes fa-lg"></i></a>
                                   <button type="button" class="btn btn-outline-info btn-sm mark-upcoming" data-toggle="tooltip" data-placement="right" title="Mark Purchased" th:data-book-id="${book.id}"><i class="fas fa-shopping-bag fa-lg"></i></button>
                               </div>
                           </div>
                       </div>
                   </section>
               </div>
           </div>
       </div>
    </div>


</main>
<footer th:replace="partials/partials.html :: footer"></footer>
<script th:src="@{/js/iziToast.min.js}"></script>
<button id="demoButton" type="button"></button>
<script th:replace="partials/partials.html :: bootstrap-j-query"></script>
<script th:replace="partials/partials.html :: popper-js"></script>
<script th:replace="partials/partials.html :: bootstrap-js"></script>
<script th:src="@{/js/profile.js}"></script>
</body>
</html>